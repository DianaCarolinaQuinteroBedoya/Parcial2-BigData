{
  "jobConfig": {
    "name": "eltiempo",
    "description": "",
    "role": "arn:aws:iam::616562572435:role/LabRole",
    "command": "pythonshell",
    "version": "1.0",
    "workerType": null,
    "numberOfWorkers": null,
    "maxCapacity": 0.0625,
    "maxRetries": 3,
    "timeout": 2880,
    "maxConcurrentRuns": 1,
    "security": "none",
    "scriptName": "eltiempo.py",
    "scriptLocation": "s3://aws-glue-assets-616562572435-us-east-1/scripts/",
    "language": "python-3",
    "jobParameters": [],
    "tags": [],
    "jobMode": "DEVELOPER_MODE",
    "developerMode": true,
    "connectionsList": [],
    "temporaryDirectory": "s3://aws-glue-assets-616562572435-us-east-1/temporary/",
    "glueHiveMetastore": true,
    "etlAutoTuning": false,
    "flexExecution": false,
    "minFlexWorkers": null
  },
  "hasBeenSaved": false,
  "script": "import requests\r\nfrom datetime import date\r\nimport boto3\r\n\r\nS3_BUCKET = 'headlines-parcial2'\r\ns3 = boto3.client('s3')\r\n\r\ndef upload_file(file_name, bucket, object_name=None):\r\n  if object_name is None:\r\n    object_name = os.path.basename(file_name)\r\n    try:\r\n      response = s3.upload_file(file_name, bucket, object_name)\r\n    except ClientError as e: \r\n      logging.error(e)\r\n      return False\r\n    return True   \r\n\r\nurl = \"https://www.eltiempo.com\"\r\nname = \"El Tiempo\"\r\nfecha = date.today()\r\nresponse = requests.get(url)\r\ns3 = boto3.client('s3')\r\nwith open(\"/tmp/eltiempo.html\",'wb+') as f:\r\n    f.write(response.content)\r\n    f.close()\r\nwith open(\"/tmp/eltiempo.html\", \"rb+\") as f:\r\n    s3.upload_fileobj(f, S3_BUCKET, f\"raw/periodico={name}/year={fecha.year}/month={fecha.month}/day={fecha.day}/eltiempo-{fecha}.html\")\r\n    f.close()"
}